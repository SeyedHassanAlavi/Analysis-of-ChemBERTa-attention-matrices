
# How Attention Mechanism Works in ChemBERTa

In this project, we have extracted attention matrices for a large number of SMILES sequences and checked which chemical properties they are associated with, the results of which can be seen in the images below.
We have also presented an innovative method that can produce one or more more optimal drugs by making changes on the sequence of SMILES related to a drug.

Results of attention analysis on number tokens:
![numbers (1)](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/ec183664-62c5-4c16-9639-a238fe8e6b81)
examples:
![AttendToDigitsExample](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/bb6b7a76-797f-41ef-9a0a-4b1266452eb3)


Results of attention analysis on ring atom tokens:
![rings](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/15a43d90-0dac-4781-9594-954a85bafefe)
examples:
![AttendToRingsExample](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/7eb2f008-f174-4a89-8cc6-cbb52b9a9007)

Results of attention analysis on chiral atom tokens:
![chiral](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/500185f6-1a38-4165-9193-59bf59d0f5ce)
examples:
![AttendToChiralityExample](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/56d03fec-b21d-4a42-a0df-3e9c250a9713)


Results of attention analysis on double bond tokens:
![double](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/31f1e7bb-9e77-4f38-afdd-4c68aeaad09f)

Results of attention analysis on triple bond tokens:
![triplet](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/e6639995-2cdf-4d0d-b216-e8b08acfbca7)
examples:
![AttendToBondExample](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/7e46208b-da1a-4549-a8a0-07fc3eaa7e9c)


SMILES Optimization example:
![OptimizationExample](https://github.com/SeyedHassanAlavi/Analysis-of-ChemBERTa-attention-matrices/assets/44578859/c178f978-88f8-4cea-bd22-fceb79244aef)


